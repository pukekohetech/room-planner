<!DOCTYPE html>
<html lang="en">
<head>
  <!-- PWA manifest and mobile support (keep if you're using these) -->
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#0b5fff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="/icons/icon-192.png">
  <meta name="mobile-web-app-capable" content="yes">

  <meta charset="UTF-8" />
  <title>Floor Plan Builder</title>
  <link rel="stylesheet" href="style.css" />
</head>


<body>
  <header id="app-header">
    <div class="header-content">
      <h1>Floor Plan Builder</h1>
      <div class="school-label">
        Pukekohe High School - LC - Room Maker
      </div>
    </div>
  </header>
  <div id="app">
    <!-- LEFT SIDEBAR: Controls & Settings -->
    <div id="sidebar">

      <!-- Top Toolbar: Tools and Settings -->
            <!-- Top Toolbar: Tools and Settings -->
      <div id="controls">
        <!-- Primary: Add Room (most used) -->
        <button id="addRectBtn" class="primary-btn">
          <svg width="10" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2"/>
          </svg>
          Add Room
        </button>

        <!-- Secondary tools -->
        <button id="addDoorBtn">
          <svg width="10" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/>
            <path d="M9 10h.01"/>
            <circle cx="12" cy="15" r="1"/>
          </svg>
          Add Door
        </button>

        <button id="addWindowBtn">
          <svg width="10" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 3h18v18H3z"/>
            <path d="M3 9h18"/>
            <path d="M9 21V9"/>
          </svg>
          Add Window
        </button>

<div class="toggle-control">
  <span class="toggle-label">Add Floors</span>

  <div class="toggle-right">
    <label class="switch">
      <input type="checkbox" id="toggleJoinBtn">
      <span class="slider round"></span>
    </label>
    <span id="joinStatus" class="toggle-status">ON</span>
  </div>
</div>

<div class="toggle-control">
  <span class="toggle-label">Lock Sizes</span>

  <div class="toggle-right">
    <label class="switch">
      <input type="checkbox" id="lockSizesChk">
      <span class="slider round"></span>
    </label>
    <span id="lockSizesStatus" class="toggle-status">ON</span>
  </div>
</div>

        

        <!-- Student name (full width) -->
        <label class="student-name-label">
          Name:
          <input id="studentNameInput" type="text" placeholder="e.g. Jamie Smith">
        </label>

        <!-- Scale info (full width) -->
        <span class="scale-label">
          Scale: 10px = 0.20m
        </span>
      </div>

      <!-- Room Editor Panel (shown when a room is selected) -->
      <div id="sizeEditor">
        <span class="panel-title">Edit room:</span>

        <label>
          Name
          <input id="roomNameInput" type="text" placeholder="Room name">
        </label>

        <label>
          W (m)
          <input id="widthInput" type="number" step="0.1" min="0.1">
        </label>

        <label>
          H (m)
          <input id="heightInput" type="number" step="0.1" min="0.1">
        </label>

        <div class="panel-buttons">
          <button id="applySizeBtn" class="primary-btn">Apply</button>
          <button id="cancelSizeBtn">Cancel</button>
          <button id="deleteRoomBtn" class="danger-btn">Delete room</button>
        </div>
      </div>

      <!-- Door/Window Editor Panel (shown when feature selected) -->
      <div id="featureInfo">
        <span class="panel-title">
          Selected: <span id="featureTypeLabel"></span>
        </span>

        <label>
          Width (m)
          <input id="featureWidthInput" type="number" step="0.1" min="0.1">
        </label>

        <label>
          Offset (m)
          <input id="featureOffsetInput" type="number" step="0.1" min="0">
        </label>

        <label>
          Top (m)
          <input id="featureHeadInput" type="number" step="0.1" min="0.1">
        </label>

        <div class="panel-buttons">
          <button id="deleteFeatureBtn" class="danger-btn">Delete door/window</button>
        </div>
      </div>

      <!-- Laser Cutting Instructions -->
      <div id="wallsHint">
        <strong>Laser layout (730mm × 420mm):</strong>
        <p>
          Tap/click a red wall strip or green floor to
          toggle whether it will be cut. Faded pieces are “off”.
        </p>
        <p class="hint">
          Labels are centred, in <span style="color:blue;">blue</span>,
          with the size directly underneath.
        </p>
      </div>
    </div>

    <!-- RIGHT SIDE: Floor Plan + Wall Elevations -->
    <div id="main">

      <!-- Main Floor Plan Canvas -->
      <div id="floorplanWrapper">
        <svg id="floorplan" width="1600" height="900" viewBox="0 0 1600 900">
          <!-- Rooms, doors, windows drawn here by plan.js -->
        </svg>
      </div>

      <!-- Wall Elevations & Laser Sheet Preview -->
      <div id="wallsPanel">

        <!-- Wall Settings & Download -->
        <div id="wallsControls">
          <span>Wall elevations:</span>

          <label>
            Wall height (m)
            <input id="wallHeightInput" type="number" step="0.1" min="1" value="2.4">
          </label>

          <label>
            Material (mm)
            <input id="materialThicknessInput" type="number" step="0.5" min="1" value="4">
          </label>

          <span class="hint">Laser bed: 730mm × 420mm</span>

          <!-- Prominent Download Button -->
          <button id="downloadSheetsBtn" class="primary-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="7 10 12 15 17 10"/>
              <path d="M12 15V3"/>
            </svg>
            Download SVG sheets
          </button>
        </div>

        <!-- Laser Sheet Layout Preview -->
        <div id="wallsWrapper">
          <svg id="wallsSvg" width="730" height="420" viewBox="0 0 730 420">
            <!-- Wall and floor pieces laid out here by walls.js -->
          </svg>
        </div>
      </div>
    </div>
  </div>

  <!-- Service Worker Registration (for PWA) -->
  <script type="module">
    import { registerServiceWorker } from "/register-sw.js";
    registerServiceWorker();
  </script>

  <!-- App Logic -->
  <script src="common.js"></script>
  <script src="walls.js"></script>
  <script src="plan.js"></script>
</body>

</html>
